{"ast":null,"code":"import _defineProperty from \"C:/Users/aelsh/Documents/PolyMtl/H2023/INF3710/TP4/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport { FormBuilder, Validators } from '@angular/forms';\nimport { MatDialogRef } from '@angular/material/dialog';\nimport { CommunicationService } from 'src/app/services/communication.service';\nimport { formatDate } from '@angular/common';\nimport { COMMA, ENTER } from '@angular/cdk/keycodes';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"src/app/services/communication.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/material/button\";\nimport * as i6 from \"@angular/material/icon\";\nimport * as i7 from \"@angular/material/core\";\nimport * as i8 from \"@angular/material/form-field\";\nimport * as i9 from \"@angular/material/input\";\nimport * as i10 from \"@angular/material/stepper\";\nimport * as i11 from \"@angular/material/datepicker\";\nimport * as i12 from \"@angular/material/select\";\nimport * as i13 from \"@angular-material-components/datetime-picker\";\nimport * as i14 from \"@angular/material/chips\";\nfunction ReservationFormDialogComponent_ng_template_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"Member & Dates\");\n  }\n}\nfunction ReservationFormDialogComponent_ng_template_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"Choose Vehicle\");\n  }\n}\nfunction ReservationFormDialogComponent_mat_option_34_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 26);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const vehicle_r8 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", vehicle_r8.plate);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate3(\" \", vehicle_r8.brand, \" - \", vehicle_r8.model, \" (\", vehicle_r8.plate, \") \");\n  }\n}\nfunction ReservationFormDialogComponent_mat_chip_row_40_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-chip-row\", 27);\n    i0.ɵɵlistener(\"removed\", function ReservationFormDialogComponent_mat_chip_row_40_Template_mat_chip_row_removed_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const requirement_r9 = restoredCtx.$implicit;\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.remove(requirement_r9));\n    })(\"edited\", function ReservationFormDialogComponent_mat_chip_row_40_Template_mat_chip_row_edited_0_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const requirement_r9 = restoredCtx.$implicit;\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.edit(requirement_r9, $event));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementStart(2, \"button\", 28)(3, \"mat-icon\");\n    i0.ɵɵtext(4, \"cancel\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const requirement_r9 = ctx.$implicit;\n    i0.ɵɵproperty(\"editable\", true)(\"aria-description\", \"press enter to edit \" + requirement_r9);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", requirement_r9, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵattribute(\"aria-label\", \"remove \" + requirement_r9);\n  }\n}\nexport let ReservationFormDialogComponent = /*#__PURE__*/(() => {\n  class ReservationFormDialogComponent {\n    constructor(fb, dialogRef, http) {\n      _defineProperty(this, \"fb\", void 0);\n      _defineProperty(this, \"dialogRef\", void 0);\n      _defineProperty(this, \"http\", void 0);\n      _defineProperty(this, \"firstFormGroup\", void 0);\n      _defineProperty(this, \"secondFormGroup\", void 0);\n      _defineProperty(this, \"vehicles\", []);\n      _defineProperty(this, \"addOnBlur\", true);\n      _defineProperty(this, \"separatorKeysCodes\", [ENTER, COMMA]);\n      _defineProperty(this, \"requirements\", ['GPS']);\n      this.fb = fb;\n      this.dialogRef = dialogRef;\n      this.http = http;\n      this.createFormGroups();\n    }\n    createFormGroups() {\n      this.firstFormGroup = this.fb.group({\n        membernum: ['', Validators.required],\n        startdate: ['', Validators.required],\n        enddate: ['', Validators.required]\n      });\n      this.secondFormGroup = this.fb.group({\n        vehicleplate: ['', Validators.required]\n      });\n    }\n    retrieveVehicles() {\n      // Get the start and end dates from the formGroup\n      if (this.firstFormGroup.valid) {\n        const startDate = this.firstFormGroup.get('startdate')?.value;\n        const endDate = this.firstFormGroup.get('enddate')?.value;\n        // Convert the start and end dates into TIMESTAMP format\n        const startDateTimestamp = formatDate(startDate, 'yyyy-MM-dd HH:mm:ss', 'en');\n        const endDateTimestamp = formatDate(endDate, 'yyyy-MM-dd HH:mm:ss', 'en');\n        // Call the service method to fetch available vehicles during the date range\n        this.http.getAvailableVehicles(startDateTimestamp, endDateTimestamp).subscribe(vehicles => {\n          this.vehicles = vehicles;\n        });\n      }\n    }\n    onSubmit() {\n      if (this.firstFormGroup.valid && this.secondFormGroup.valid) {\n        const requirementsString = this.requirements.join(', ');\n        const reservation = {\n          reservationid: this.generateReservationId(),\n          vehicleplate: this.secondFormGroup.value.vehicleplate,\n          startdate: this.firstFormGroup.value.startdate,\n          enddate: this.firstFormGroup.value.enddate,\n          requirements: requirementsString,\n          membernum: this.firstFormGroup.value.membernum\n        };\n        // Send the reservation object to the server to save it in the database\n        this.http.createReservation(reservation).subscribe(() => {\n          this.requirements = ['GPS'];\n          this.dialogRef.close();\n        });\n      }\n    }\n    add(event) {\n      const value = (event.value || '').trim();\n      // Add our fruit\n      if (value) {\n        this.requirements.push(value);\n      }\n      // Clear the input value\n      event.chipInput.clear();\n    }\n    remove(requirement) {\n      const index = this.requirements.indexOf(requirement);\n      if (index >= 0) {\n        this.requirements.splice(index, 1);\n      }\n    }\n    edit(requirement, event) {\n      const value = event.value.trim();\n      // Remove fruit if it no longer has a name\n      if (!value) {\n        this.remove(requirement);\n        return;\n      }\n      // Edit existing fruit\n      const index = this.requirements.indexOf(requirement);\n      if (index >= 0) {\n        this.requirements[index] = value;\n      }\n    }\n    generateReservationId() {\n      return Math.random().toString(36).substr(2, 10).toUpperCase();\n    }\n  }\n  _defineProperty(ReservationFormDialogComponent, \"\\u0275fac\", function ReservationFormDialogComponent_Factory(t) {\n    return new (t || ReservationFormDialogComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.MatDialogRef), i0.ɵɵdirectiveInject(i3.CommunicationService));\n  });\n  _defineProperty(ReservationFormDialogComponent, \"\\u0275cmp\", /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ReservationFormDialogComponent,\n    selectors: [[\"app-reservation-form-dialog\"]],\n    decls: 47,\n    vars: 14,\n    consts: [[1, \"form\"], [3, \"linear\"], [\"stepper\", \"\"], [1, \"stepper\", 3, \"stepControl\"], [3, \"formGroup\"], [\"matStepLabel\", \"\", \"class\", \"stepper\"], [\"appearance\", \"fill\", 2, \"padding-top\", \"5px\"], [\"matInput\", \"\", \"formControlName\", \"membernum\", \"placeholder\", \"Member Number\"], [\"appearance\", \"outline\"], [\"matInput\", \"\", \"readonly\", \"\", \"formControlName\", \"startdate\", \"placeholder\", \"Start Date\", 3, \"ngxMatDatetimePicker\"], [\"matSuffix\", \"\", 3, \"for\"], [\"startDatePicker\", \"\"], [\"matInput\", \"\", \"readonly\", \"\", \"formControlName\", \"enddate\", \"placeholder\", \"End Date\", 3, \"ngxMatDatetimePicker\"], [\"endDatePicker\", \"\"], [\"mat-button\", \"\", \"matStepperNext\", \"\", 3, \"click\"], [3, \"stepControl\"], [\"matStepLabel\", \"\"], [\"formControlName\", \"vehicleplate\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"appearance\", \"fill\", 1, \"example-chip-list\"], [\"aria-label\", \"Add new\"], [\"chipGrid\", \"\"], [3, \"editable\", \"aria-description\", \"removed\", \"edited\", 4, \"ngFor\", \"ngForOf\"], [\"placeholder\", \"Add new\", 3, \"matChipInputFor\", \"matChipInputSeparatorKeyCodes\", \"matChipInputAddOnBlur\", \"matChipInputTokenEnd\"], [\"mat-button\", \"\", \"matStepperPrevious\", \"\"], [\"mat-button\", \"\", 3, \"click\"], [3, \"value\"], [3, \"editable\", \"aria-description\", \"removed\", \"edited\"], [\"matChipRemove\", \"\"]],\n    template: function ReservationFormDialogComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"mat-dialog-content\", 0)(1, \"mat-horizontal-stepper\", 1, 2)(3, \"mat-step\", 3)(4, \"form\", 4);\n        i0.ɵɵtemplate(5, ReservationFormDialogComponent_ng_template_5_Template, 1, 0, \"ng-template\", 5);\n        i0.ɵɵelementStart(6, \"mat-form-field\", 6)(7, \"mat-label\");\n        i0.ɵɵtext(8, \"Member Number\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(9, \"input\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"mat-form-field\", 8)(11, \"mat-label\");\n        i0.ɵɵtext(12, \"Start Date\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(13, \"input\", 9)(14, \"mat-datepicker-toggle\", 10)(15, \"ngx-mat-datetime-picker\", null, 11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"mat-form-field\", 8)(18, \"mat-label\");\n        i0.ɵɵtext(19, \"End Date\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(20, \"input\", 12)(21, \"mat-datepicker-toggle\", 10)(22, \"ngx-mat-datetime-picker\", null, 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"div\")(25, \"button\", 14);\n        i0.ɵɵlistener(\"click\", function ReservationFormDialogComponent_Template_button_click_25_listener() {\n          return ctx.retrieveVehicles();\n        });\n        i0.ɵɵtext(26, \"Next\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(27, \"mat-step\", 15)(28, \"form\", 4);\n        i0.ɵɵtemplate(29, ReservationFormDialogComponent_ng_template_29_Template, 1, 0, \"ng-template\", 16);\n        i0.ɵɵelementStart(30, \"mat-form-field\", 6)(31, \"mat-label\");\n        i0.ɵɵtext(32, \"Vehicle\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(33, \"mat-select\", 17);\n        i0.ɵɵtemplate(34, ReservationFormDialogComponent_mat_option_34_Template, 2, 4, \"mat-option\", 18);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(35, \"mat-form-field\", 19)(36, \"mat-label\");\n        i0.ɵɵtext(37, \"Requirements\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(38, \"mat-chip-grid\", 20, 21);\n        i0.ɵɵtemplate(40, ReservationFormDialogComponent_mat_chip_row_40_Template, 5, 4, \"mat-chip-row\", 22);\n        i0.ɵɵelementStart(41, \"input\", 23);\n        i0.ɵɵlistener(\"matChipInputTokenEnd\", function ReservationFormDialogComponent_Template_input_matChipInputTokenEnd_41_listener($event) {\n          return ctx.add($event);\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(42, \"div\")(43, \"button\", 24);\n        i0.ɵɵtext(44, \"Back\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(45, \"button\", 25);\n        i0.ɵɵlistener(\"click\", function ReservationFormDialogComponent_Template_button_click_45_listener() {\n          return ctx.onSubmit();\n        });\n        i0.ɵɵtext(46, \"Confirm\");\n        i0.ɵɵelementEnd()()()()()();\n      }\n      if (rf & 2) {\n        const _r2 = i0.ɵɵreference(16);\n        const _r3 = i0.ɵɵreference(23);\n        const _r6 = i0.ɵɵreference(39);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"linear\", true);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"stepControl\", ctx.firstFormGroup);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"formGroup\", ctx.firstFormGroup);\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"ngxMatDatetimePicker\", _r2);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"for\", _r2);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngxMatDatetimePicker\", _r3);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"for\", _r3);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"stepControl\", ctx.secondFormGroup);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"formGroup\", ctx.secondFormGroup);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngForOf\", ctx.vehicles);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngForOf\", ctx.requirements);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"matChipInputFor\", _r6)(\"matChipInputSeparatorKeyCodes\", ctx.separatorKeysCodes)(\"matChipInputAddOnBlur\", ctx.addOnBlur);\n      }\n    },\n    dependencies: [i4.NgForOf, i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName, i5.MatButton, i6.MatIcon, i2.MatDialogContent, i7.MatOption, i8.MatFormField, i8.MatLabel, i8.MatSuffix, i9.MatInput, i10.MatStep, i10.MatStepLabel, i10.MatStepper, i10.MatStepperNext, i10.MatStepperPrevious, i11.MatDatepickerToggle, i12.MatSelect, i13.NgxMatDatetimePicker, i13.NgxMatDatetimeInput, i14.MatChipGrid, i14.MatChipInput, i14.MatChipRemove, i14.MatChipRow],\n    styles: [\".stepper[_ngcontent-%COMP%]{padding:5px}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:15px;width:100%;max-width:400px;margin:0 auto}mat-form-field[_ngcontent-%COMP%]{width:100%}.submit-button[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:20px}.form-title[_ngcontent-%COMP%]{text-align:center;font-size:24px;font-weight:300;margin-bottom:20px}.mat-dialog-container[_ngcontent-%COMP%]{padding:20px}\"]\n  }));\n  return ReservationFormDialogComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}